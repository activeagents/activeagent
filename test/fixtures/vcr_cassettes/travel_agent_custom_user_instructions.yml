---
http_interactions:
- request:
    method: post
    uri: https://api.openai.com/v1/chat/completions
    body:
      encoding: UTF-8
      string: '{"model":"gpt-4o-mini","messages":[{"role":"system","content":"This
        agent is currently interacting with Bob Smith to find a hotel near their travel
        destination.\nThe agent should use the following actions to achieve the desired
        outcome:\n\n  confirm: Confirm a flight booking\n  search: Search for available
        flights to a destination\n  book: Book a specific flight\n\nrequirements:\n-
        The agent should use the `search` action to find hotels in the requested location.\n-
        The agent should use the `book` action to book a hotel for the user.\n- The
        agent should use the `confirm` action to confirm the booking with the user."},{"role":"user","content":"I
        need to find a hotel in Paris"}],"temperature":0.7,"tools":[{"type":"function","function":{"name":"confirm","description":"Confirm
        a flight booking","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"confirmation_number":{"type":"string","description":"The
        booking confirmation number"},"send_email":{"type":"boolean","description":"Whether
        to send confirmation email"}},"required":["confirmation_number"]}},"required":["params"]}}},{"type":"function","function":{"name":"search","description":"Search
        for available flights to a destination","parameters":{"type":"object","properties":{"departure":{"type":"string","description":"Departure
        city or airport code"},"destination":{"type":"string","description":"Destination
        city or airport code"},"date":{"type":"string","description":"Travel date
        in YYYY-MM-DD format"}},"required":["destination"]}}},{"type":"function","function":{"name":"book","description":"Book
        a specific flight","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"flight_id":{"type":"string","description":"The
        flight identifier to book"},"passenger_name":{"type":"string","description":"Name
        of the passenger"},"passenger_email":{"type":"string","description":"Email
        address for booking confirmation"}},"required":["flight_id","passenger_name"]}},"required":["params"]}}}]}'
    headers:
      Content-Type:
      - application/json
      Authorization:
      - Bearer <OPENAI_ACCESS_TOKEN>
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Date:
      - Mon, 11 Aug 2025 22:51:09 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      Access-Control-Expose-Headers:
      - X-Request-ID
      Openai-Organization:
      - user-lwlf4w2yvortlzept3wqx7li
      Openai-Processing-Ms:
      - '554'
      Openai-Project:
      - proj_pcPHiweuB88laiGDTaN3nH2M
      Openai-Version:
      - '2020-10-01'
      X-Envoy-Upstream-Service-Time:
      - '572'
      X-Ratelimit-Limit-Requests:
      - '10000'
      X-Ratelimit-Limit-Tokens:
      - '200000'
      X-Ratelimit-Remaining-Requests:
      - '9977'
      X-Ratelimit-Remaining-Tokens:
      - '199852'
      X-Ratelimit-Reset-Requests:
      - 3m16.59s
      X-Ratelimit-Reset-Tokens:
      - 44ms
      X-Request-Id:
      - req_3fe2eef22291465d83f891fc57e02087
      Cf-Cache-Status:
      - DYNAMIC
      Set-Cookie:
      - __cf_bm=eofsghVKgGeuuXIKDJ75Z8qJ2Jcf3Oc_dsay.5Tf12s-1754952669-1.0.1.1-kzzjGvmOawONGM6tCTtzGm55feeskwJMfiHXI1hLTeJFnf_z2c9pZGWtL_0z_Jh_oZU7wE2fmd6P.ifn_b0TI9n5rityKAIXG5XqKXlvf.c;
        path=/; expires=Mon, 11-Aug-25 23:21:09 GMT; domain=.api.openai.com; HttpOnly;
        Secure; SameSite=None
      - _cfuvid=BHEGiaZQRRC4HgeBlmQZOJgFIwC4KOo1gcgfoMp6E9Y-1754952669456-0.0.1.1-604800000;
        path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains; preload
      X-Content-Type-Options:
      - nosniff
      Server:
      - cloudflare
      Cf-Ray:
      - 96db4bc4188a67ff-SJC
      Alt-Svc:
      - h3=":443"; ma=86400
    body:
      encoding: ASCII-8BIT
      string: |
        {
          "id": "chatcmpl-C3Ve8zNbDfYOCZjM6USGKDc7ANZKB",
          "object": "chat.completion",
          "created": 1754952668,
          "model": "gpt-4o-mini-2024-07-18",
          "choices": [
            {
              "index": 0,
              "message": {
                "role": "assistant",
                "content": null,
                "tool_calls": [
                  {
                    "id": "call_dumiRuTsZjF6E1bOJSb573Xf",
                    "type": "function",
                    "function": {
                      "name": "search",
                      "arguments": "{\"destination\":\"Paris\"}"
                    }
                  }
                ],
                "refusal": null,
                "annotations": []
              },
              "logprobs": null,
              "finish_reason": "tool_calls"
            }
          ],
          "usage": {
            "prompt_tokens": 287,
            "completion_tokens": 13,
            "total_tokens": 300,
            "prompt_tokens_details": {
              "cached_tokens": 0,
              "audio_tokens": 0
            },
            "completion_tokens_details": {
              "reasoning_tokens": 0,
              "audio_tokens": 0,
              "accepted_prediction_tokens": 0,
              "rejected_prediction_tokens": 0
            }
          },
          "service_tier": "default",
          "system_fingerprint": "fp_34a54ae93c"
        }
  recorded_at: Mon, 11 Aug 2025 22:51:09 GMT
- request:
    method: post
    uri: https://api.openai.com/v1/chat/completions
    body:
      encoding: UTF-8
      string: '{"model":"gpt-4o-mini","messages":[{"role":"system","content":"This
        agent is currently interacting with Bob Smith to find a hotel near their travel
        destination.\nThe agent should use the following actions to achieve the desired
        outcome:\n\n  confirm: Confirm a flight booking\n  book: Book a specific flight\n\nrequirements:\n-
        The agent should use the `search` action to find hotels in the requested location.\n-
        The agent should use the `book` action to book a hotel for the user.\n- The
        agent should use the `confirm` action to confirm the booking with the user."},{"role":"user","content":"I
        need to find a hotel in Paris"},{"role":"assistant","content":"","tool_calls":[{"type":"function","function":{"name":"search","arguments":"{\"destination\":\"Paris\"}"},"id":"call_dumiRuTsZjF6E1bOJSb573Xf"}]},{"role":"tool","content":"\u003ch2\u003eTravel
        Search Results\u003c/h2\u003e\n\n\u003cp\u003eSearching for flights from  to
        Paris\u003c/p\u003e\n\n\u003cul\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWould
        you like to book any of these flights?\u003c/p\u003e\n","tool_call_id":"call_dumiRuTsZjF6E1bOJSb573Xf","name":"search"}],"temperature":0.7,"tools":[{"type":"function","function":{"name":"confirm","description":"Confirm
        a flight booking","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"confirmation_number":{"type":"string","description":"The
        booking confirmation number"},"send_email":{"type":"boolean","description":"Whether
        to send confirmation email"}},"required":["confirmation_number"]}},"required":["params"]}}},{"type":"function","function":{"name":"search","description":"Search
        for available flights to a destination","parameters":{"type":"object","properties":{"departure":{"type":"string","description":"Departure
        city or airport code"},"destination":{"type":"string","description":"Destination
        city or airport code"},"date":{"type":"string","description":"Travel date
        in YYYY-MM-DD format"}},"required":["destination"]}}},{"type":"function","function":{"name":"book","description":"Book
        a specific flight","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"flight_id":{"type":"string","description":"The
        flight identifier to book"},"passenger_name":{"type":"string","description":"Name
        of the passenger"},"passenger_email":{"type":"string","description":"Email
        address for booking confirmation"}},"required":["flight_id","passenger_name"]}},"required":["params"]}}}]}'
    headers:
      Content-Type:
      - application/json
      Authorization:
      - Bearer <OPENAI_ACCESS_TOKEN>
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Date:
      - Mon, 11 Aug 2025 22:51:10 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      Access-Control-Expose-Headers:
      - X-Request-ID
      Openai-Organization:
      - user-lwlf4w2yvortlzept3wqx7li
      Openai-Processing-Ms:
      - '1168'
      Openai-Project:
      - proj_pcPHiweuB88laiGDTaN3nH2M
      Openai-Version:
      - '2020-10-01'
      X-Envoy-Upstream-Service-Time:
      - '1186'
      X-Ratelimit-Limit-Requests:
      - '10000'
      X-Ratelimit-Limit-Tokens:
      - '200000'
      X-Ratelimit-Remaining-Requests:
      - '9973'
      X-Ratelimit-Remaining-Tokens:
      - '199828'
      X-Ratelimit-Reset-Requests:
      - 3m52.296s
      X-Ratelimit-Reset-Tokens:
      - 51ms
      X-Request-Id:
      - req_dbea17bb11d84e20a588713e3c125c7e
      Cf-Cache-Status:
      - DYNAMIC
      Set-Cookie:
      - __cf_bm=qsYqSnlqhDM52U6Sz3PASA8tgrTHkENjv.7OhyiEX_w-1754952670-1.0.1.1-crX4GWhaZgQNm3h235DZOPjp0en9cMv1fcsgEwJ7op4IGeVgwI2UBfRsEzJKZwBu9JsplzDFmjUtvXvLhhjc334ECLSSG_7znor9MTgfyF8;
        path=/; expires=Mon, 11-Aug-25 23:21:10 GMT; domain=.api.openai.com; HttpOnly;
        Secure; SameSite=None
      - _cfuvid=ZtCak94DRjmWaxccXo0pTWbb4JB41wiGSa2F0QSGeTU-1754952670785-0.0.1.1-604800000;
        path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains; preload
      X-Content-Type-Options:
      - nosniff
      Server:
      - cloudflare
      Cf-Ray:
      - 96db4bc88cfa270c-SJC
      Alt-Svc:
      - h3=":443"; ma=86400
    body:
      encoding: ASCII-8BIT
      string: |
        {
          "id": "chatcmpl-C3Ve9IQ7DsRfjQJm7kFyBwGuRhpaE",
          "object": "chat.completion",
          "created": 1754952669,
          "model": "gpt-4o-mini-2024-07-18",
          "choices": [
            {
              "index": 0,
              "message": {
                "role": "assistant",
                "content": "It seems there was an issue with the search results for hotels in Paris. Let me try again to find available hotels for you.",
                "tool_calls": [
                  {
                    "id": "call_RB8gX1IhYp7hrfRBK8FF5Ny3",
                    "type": "function",
                    "function": {
                      "name": "search",
                      "arguments": "{\"destination\":\"Paris\"}"
                    }
                  }
                ],
                "refusal": null,
                "annotations": []
              },
              "logprobs": null,
              "finish_reason": "tool_calls"
            }
          ],
          "usage": {
            "prompt_tokens": 337,
            "completion_tokens": 40,
            "total_tokens": 377,
            "prompt_tokens_details": {
              "cached_tokens": 0,
              "audio_tokens": 0
            },
            "completion_tokens_details": {
              "reasoning_tokens": 0,
              "audio_tokens": 0,
              "accepted_prediction_tokens": 0,
              "rejected_prediction_tokens": 0
            }
          },
          "service_tier": "default",
          "system_fingerprint": "fp_34a54ae93c"
        }
  recorded_at: Mon, 11 Aug 2025 22:51:10 GMT
- request:
    method: post
    uri: https://api.openai.com/v1/chat/completions
    body:
      encoding: UTF-8
      string: '{"model":"gpt-4o-mini","messages":[{"role":"system","content":"This
        agent is currently interacting with Bob Smith to find a hotel near their travel
        destination.\nThe agent should use the following actions to achieve the desired
        outcome:\n\n  confirm: Confirm a flight booking\n  book: Book a specific flight\n\nrequirements:\n-
        The agent should use the `search` action to find hotels in the requested location.\n-
        The agent should use the `book` action to book a hotel for the user.\n- The
        agent should use the `confirm` action to confirm the booking with the user."},{"role":"user","content":"I
        need to find a hotel in Paris"},{"role":"assistant","content":"","tool_calls":[{"type":"function","function":{"name":"search","arguments":"{\"destination\":\"Paris\"}"},"id":"call_dumiRuTsZjF6E1bOJSb573Xf"}]},{"role":"tool","content":"\u003ch2\u003eTravel
        Search Results\u003c/h2\u003e\n\n\u003cp\u003eSearching for flights from  to
        Paris\u003c/p\u003e\n\n\u003cul\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWould
        you like to book any of these flights?\u003c/p\u003e\n","tool_call_id":"call_dumiRuTsZjF6E1bOJSb573Xf","name":"search"},{"role":"assistant","content":"It
        seems there was an issue with the search results for hotels in Paris. Let
        me try again to find available hotels for you.","tool_calls":[{"type":"function","function":{"name":"search","arguments":"{\"destination\":\"Paris\"}"},"id":"call_RB8gX1IhYp7hrfRBK8FF5Ny3"}]},{"role":"tool","content":"\u003ch2\u003eTravel
        Search Results\u003c/h2\u003e\n\n\u003cp\u003eSearching for flights from  to
        Paris\u003c/p\u003e\n\n\u003cul\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWould
        you like to book any of these flights?\u003c/p\u003e\n","tool_call_id":"call_RB8gX1IhYp7hrfRBK8FF5Ny3","name":"search"}],"temperature":0.7,"tools":[{"type":"function","function":{"name":"confirm","description":"Confirm
        a flight booking","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"confirmation_number":{"type":"string","description":"The
        booking confirmation number"},"send_email":{"type":"boolean","description":"Whether
        to send confirmation email"}},"required":["confirmation_number"]}},"required":["params"]}}},{"type":"function","function":{"name":"search","description":"Search
        for available flights to a destination","parameters":{"type":"object","properties":{"departure":{"type":"string","description":"Departure
        city or airport code"},"destination":{"type":"string","description":"Destination
        city or airport code"},"date":{"type":"string","description":"Travel date
        in YYYY-MM-DD format"}},"required":["destination"]}}},{"type":"function","function":{"name":"book","description":"Book
        a specific flight","parameters":{"type":"object","properties":{"params":{"type":"object","properties":{"flight_id":{"type":"string","description":"The
        flight identifier to book"},"passenger_name":{"type":"string","description":"Name
        of the passenger"},"passenger_email":{"type":"string","description":"Email
        address for booking confirmation"}},"required":["flight_id","passenger_name"]}},"required":["params"]}}}]}'
    headers:
      Content-Type:
      - application/json
      Authorization:
      - Bearer <OPENAI_ACCESS_TOKEN>
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Date:
      - Mon, 11 Aug 2025 22:51:11 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      Access-Control-Expose-Headers:
      - X-Request-ID
      Openai-Organization:
      - user-lwlf4w2yvortlzept3wqx7li
      Openai-Processing-Ms:
      - '888'
      Openai-Project:
      - proj_pcPHiweuB88laiGDTaN3nH2M
      Openai-Version:
      - '2020-10-01'
      X-Envoy-Upstream-Service-Time:
      - '918'
      X-Ratelimit-Limit-Requests:
      - '10000'
      X-Ratelimit-Limit-Tokens:
      - '200000'
      X-Ratelimit-Remaining-Requests:
      - '9974'
      X-Ratelimit-Remaining-Tokens:
      - '199760'
      X-Ratelimit-Reset-Requests:
      - 3m40.485s
      X-Ratelimit-Reset-Tokens:
      - 72ms
      X-Request-Id:
      - req_3ddfa3d7d2bb497fa9acac9862fad20f
      Cf-Cache-Status:
      - DYNAMIC
      Set-Cookie:
      - __cf_bm=V5uTGOanD03ufoSR5MtcIvhu38N5_2VReGxxdMYIrD4-1754952671-1.0.1.1-rhwgnFceeEfTGHD8TJzwgZDQfIwMcYaJy9PnNGog0gBLPe9XnCD_4fb54DzG2CqmVz8Q0QhikHjfTKDhLvgwekyq0zp4KTfFdbv5llBkiSU;
        path=/; expires=Mon, 11-Aug-25 23:21:11 GMT; domain=.api.openai.com; HttpOnly;
        Secure; SameSite=None
      - _cfuvid=_2w80bhHKzftTXcUCZYZDZUhrK5718mTayOpSotiHHo-1754952671829-0.0.1.1-604800000;
        path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains; preload
      X-Content-Type-Options:
      - nosniff
      Server:
      - cloudflare
      Cf-Ray:
      - 96db4bd0cec37ae0-SJC
      Alt-Svc:
      - h3=":443"; ma=86400
    body:
      encoding: ASCII-8BIT
      string: |
        {
          "id": "chatcmpl-C3VeBZ1gELOCsy7ciewyv7H5xppp5",
          "object": "chat.completion",
          "created": 1754952671,
          "model": "gpt-4o-mini-2024-07-18",
          "choices": [
            {
              "index": 0,
              "message": {
                "role": "assistant",
                "content": "It looks like I'm having trouble retrieving hotel options in Paris at the moment. Could you please specify the dates of your stay or any preferences you have for the hotel? This will help me narrow down the search.",
                "refusal": null,
                "annotations": []
              },
              "logprobs": null,
              "finish_reason": "stop"
            }
          ],
          "usage": {
            "prompt_tokens": 428,
            "completion_tokens": 43,
            "total_tokens": 471,
            "prompt_tokens_details": {
              "cached_tokens": 0,
              "audio_tokens": 0
            },
            "completion_tokens_details": {
              "reasoning_tokens": 0,
              "audio_tokens": 0,
              "accepted_prediction_tokens": 0,
              "rejected_prediction_tokens": 0
            }
          },
          "service_tier": "default",
          "system_fingerprint": "fp_34a54ae93c"
        }
  recorded_at: Mon, 11 Aug 2025 22:51:11 GMT
recorded_with: VCR 6.3.1
